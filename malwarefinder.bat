@echo off
setlocal enabledelayedexpansion

REM Define the list of TLDs
set "tlds=.sbs .cyou .vg .cfd .quest .top .autos .cloud .makeup .skin .icu .shop .life .homes .buzz .xyz .best .ink .bd .bio .store .website .today .monster .space .th .pro .live .site .pk .id .tz .to .click .club .cn .am .mk .fun .bond .cc .tr .link .ru .ng .su .pics .ke .lk .sa"

REM Define the length of the random URL
set "url_length=4"

REM Generate a random URL
set "characters=abcdefghijklmnopqrstuvwxyz0123456789"
set "url="
for /l %%i in (1,1,%url_length%) do (
    set /a "random_index=!random! %% 36"
    for %%j in (!random_index!) do set "char=!characters:~%%j,1!"
    set "url=!url!!char!"
)

REM Select a random TLD from the list
for %%t in (%tlds%) do (
    set "random_tld=%%t"
    set /a "random_index=!random! %% 5"
    if !random_index! equ 0 goto :Break
)

:Break

REM Display the random URL
echo Downloading: %url%%random_tld%
curl -o "C:\MalwareFinder\%url%%random_tld%" %url%%random_tld%

endlocal
