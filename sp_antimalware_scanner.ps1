# Parameters
$file = $args[0]
$searchStrings = @{
    "MZ" = "examplemalware11"
}

# Read file as byte array
$fileBytes = [System.IO.File]::ReadAllBytes($file)

# Convert byte array to string
$fileContent = [System.Text.Encoding]::Default.GetString($fileBytes)

# Perform string search
$detectedStrings = foreach ($key in $searchStrings.Keys) {
    $alias = $searchStrings[$key]
    if ($fileContent -match [regex]::Escape($alias)) {
        $key
    }
}

# Output detections
if ($detectedStrings) {
    Write-Host "Detected strings:"
    foreach ($detectedString in $detectedStrings) {
        $alias = $searchStrings[$detectedString]
        Write-Host "- $detectedString ($alias)"
    }
}
else {
    Write-Host "No malicious strings detected."
}
