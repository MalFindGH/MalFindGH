# Parameters
$file = $args[0]
$searchStrings = @{
    "MZ" = "examplemalware11"
}

# Read file content
$fileContent = Get-Content -Path $file -Raw

# Perform string search
$detectedStrings = foreach ($searchString in $searchStrings.Keys) {
    $alias = $searchStrings[$searchString]
    if ($fileContent -match $alias) {
        $searchString
    }
}

# Output detections
if ($detectedStrings) {
    Write-Host "Detected malware:
    "
    $detectedStrings | ForEach-Object { Write-Host "- $_ ($($searchStrings[$_]))" }
}
else {
    Write-Host "No malicious code detected."
}
