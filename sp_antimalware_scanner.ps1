# Parameters
$file = $args[0]
$searchStrings = @{
    "MZ" = "examplemalware11"
}
$encoding = [System.Text.Encoding]::UTF8  # Update with the correct encoding if necessary

# Read file content
$fileContent = [System.IO.File]::ReadAllText($file, $encoding)

# Perform string search
$detectedStrings = foreach ($key in $searchStrings.Keys) {
    $alias = $searchStrings[$key]
    if ($fileContent -match [regex]::Escape($alias)) {
        $key
    }
}

# Output detections
if ($detectedStrings) {
    Write-Host "Detected strings:"
    foreach ($detectedString in $detectedStrings) {
        $alias = $searchStrings[$detectedString]
        Write-Host "- $detectedString ($alias)"
    }
}
else {
    Write-Host "No malicious strings detected."
}
